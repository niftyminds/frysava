---
import yaml from 'js-yaml';
import fs from 'fs';
import path from 'path';

const pricingDataPath = path.join(process.cwd(), 'src/data/pricing.yaml');
const pricingData = yaml.load(fs.readFileSync(pricingDataPath, 'utf8'));
---

<section id="cenik" class="section bg-white">
  <div class="container">
    <h2 class="text-center mb-4">Ceník</h2>
    <p class="text-center text-charcoal-600 mb-12 max-w-2xl mx-auto">
      Transparentní ceník bez skrytých poplatků
    </p>

    <!-- Main Pricing Table -->
    <div class="max-w-4xl mx-auto mb-12">
      <div class="bg-gradient-to-br from-sand-50 to-moss-50 rounded-xl overflow-hidden shadow-lg border border-sand-200">
        <table class="w-full">
          <thead>
            <tr class="bg-moss-600 text-white">
              <th class="px-6 py-4 text-left">Období</th>
              <th class="px-6 py-4 text-left">Termín</th>
              <th class="px-6 py-4 text-right">Cena</th>
            </tr>
          </thead>
          <tbody>
            {pricingData.seasons.map((season, index) => (
              <tr class={index % 2 === 0 ? 'bg-white' : 'bg-sand-50/50'}>
                <td class="px-6 py-4 font-semibold text-wood-900">{season.name}</td>
                <td class="px-6 py-4 text-charcoal-700">{season.period}</td>
                <td class="px-6 py-4 text-right">
                  <span class="text-2xl font-bold text-moss-700">
                    {season.price_per_person} {season.currency}
                  </span>
                  <span class="text-sm text-charcoal-600 block">/ osoba / noc</span>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>

    <!-- Additional Fees -->
    <div class="max-w-4xl mx-auto mb-12">
      <h3 class="text-2xl font-semibold text-wood-900 mb-6">Dodatečné poplatky</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        {pricingData.fees.map((fee) => (
          <div class="bg-sand-50 rounded-lg p-4 border border-sand-200">
            <div class="flex justify-between items-start">
              <div>
                <p class="font-semibold text-wood-900">{fee.name}</p>
                <p class="text-sm text-charcoal-600">{fee.unit}</p>
              </div>
              <p class="text-lg font-bold text-charcoal-900">
                {fee.note && <span class="text-sm font-normal">{fee.note} </span>}
                {fee.price} Kč
              </p>
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Check-in/Check-out -->
    {pricingData.checkin_checkout && (
      <div class="max-w-4xl mx-auto mb-12 bg-moss-50 border-2 border-moss-200 rounded-xl p-6">
        <h3 class="text-xl font-semibold text-wood-900 mb-4">Check-in / Check-out</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="flex items-center gap-3">
            <svg class="w-8 h-8 text-moss-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path>
            </svg>
            <div>
              <p class="font-semibold text-wood-900">Check-in od</p>
              <p class="text-charcoal-700">{pricingData.checkin_checkout.checkin_from}</p>
            </div>
          </div>
          <div class="flex items-center gap-3">
            <svg class="w-8 h-8 text-moss-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
            </svg>
            <div>
              <p class="font-semibold text-wood-900">Check-out do</p>
              <p class="text-charcoal-700">{pricingData.checkin_checkout.checkout_until}</p>
            </div>
          </div>
        </div>
        {pricingData.checkin_checkout.note && (
          <p class="mt-4 text-sm text-charcoal-600 italic">{pricingData.checkin_checkout.note}</p>
        )}
      </div>
    )}

    <!-- Cancellation Policy -->
    {pricingData.cancellation && (
      <div class="max-w-4xl mx-auto bg-wood-50 border-2 border-wood-200 rounded-xl p-6">
        <h3 class="text-xl font-semibold text-wood-900 mb-4">Stornopodmínky</h3>
        <ul class="space-y-3">
          {pricingData.cancellation.map((policy) => (
            <li class="flex items-start gap-3">
              <svg class="w-5 h-5 text-wood-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
              <div>
                <span class="font-semibold text-wood-900">{policy.period}:</span>
                <span class="text-charcoal-700"> {policy.description}</span>
              </div>
            </li>
          ))}
        </ul>
      </div>
    )}

    <!-- Notes -->
    {pricingData.notes && (
      <div class="max-w-4xl mx-auto mt-8 text-center">
        {pricingData.notes.map((note) => (
          <p class="text-sm text-charcoal-600 italic">{note}</p>
        ))}
      </div>
    )}

    <!-- CTA -->
    <div class="text-center mt-12">
      <a href="#kontakt" class="btn-primary text-lg px-8 py-4">
        Poptat termín
      </a>
    </div>
  </div>
</section>
