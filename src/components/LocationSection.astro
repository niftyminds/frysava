---
import yaml from 'js-yaml';
import fs from 'fs';
import path from 'path';

const aboutDataPath = path.join(process.cwd(), 'src/data/about.yaml');
const siteDataPath = path.join(process.cwd(), 'src/data/site.yaml');

const aboutData = yaml.load(fs.readFileSync(aboutDataPath, 'utf8'));
const siteData = yaml.load(fs.readFileSync(siteDataPath, 'utf8'));

// Icon map for location-related SVG icons
const iconMap = {
  'fish': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>',
  'shopping-cart': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path>',
  'utensils': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>',
  'waves': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10l-2 1m0 0l-2-1m2 1v2.5M20 7l-2 1m2-1l-2-1m2 1v2.5M14 4l-2-1-2 1M4 7l2-1M4 7l2 1M4 7v2.5M12 21l-2-1m2 1l2-1m-2 1v-2.5M6 18l-2-1v-2.5M18 18l2-1v-2.5"></path>',
  'mountain-snow': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3l3.057-3L11 3m10 2l-3-3-3.943 3M4 10h16l-3-6-3 6-4-6-3 6m2 8l-2-4m12 4l2-4"></path>',
  'bike': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4"></path>',
  'sun': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>',
  'snowflake': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 2v20M2 12h20M6.343 6.343l11.314 11.314M6.343 17.657l11.314-11.314"></path>',
  'map-pin': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>',
  'chevron': '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>',
};
---

<section id="lokalita" class="section bg-white">
  <div class="container">
    <h2 class="text-center mb-4">Lokalita a okolí</h2>
    <p class="text-center text-charcoal-600 mb-12 max-w-2xl mx-auto">
      {aboutData.location.description}
    </p>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
      <!-- Map -->
      <div class="rounded-xl overflow-hidden shadow-lg aspect-square lg:aspect-auto border border-sand-200">
        <iframe
          src={`https://www.openstreetmap.org/export/embed.html?bbox=${siteData.location.gps.lng - 0.003}%2C${siteData.location.gps.lat - 0.003}%2C${siteData.location.gps.lng + 0.003}%2C${siteData.location.gps.lat + 0.003}&layer=mapnik&marker=${siteData.location.gps.lat}%2C${siteData.location.gps.lng}`}
          class="w-full h-full min-h-[400px]"
          frameborder="0"
        ></iframe>
      </div>

      <!-- Distances -->
      <div>
        <h3 class="text-2xl font-semibold text-wood-900 mb-6">Co je v okolí</h3>
        <div class="space-y-4">
          {aboutData.location.distances.map((item) => (
            <div class="flex items-start gap-4 p-4 bg-sand-50 rounded-lg hover:bg-sand-100 transition-colors border border-sand-200">
              <div class="w-8 h-8 text-moss-600 flex-shrink-0">
                <svg class="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <Fragment set:html={iconMap[item.icon] || iconMap['map-pin']} />
                </svg>
              </div>
              <div class="flex-1">
                <p class="font-semibold text-wood-900">{item.place}</p>
                <p class="text-sm text-moss-600 font-medium">{item.distance}</p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>

    <!-- Activities -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto">
      <!-- Summer Activities -->
      <div class="bg-moss-50 border-2 border-moss-200 rounded-xl p-8">
        <h3 class="text-2xl font-semibold text-wood-900 mb-4 flex items-center gap-3">
          <svg class="w-8 h-8 text-moss-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <Fragment set:html={iconMap['sun']} />
          </svg>
          Letní aktivity
        </h3>
        <ul class="space-y-3">
          {aboutData.location.activities.summer.map((activity) => (
            <li class="flex items-start gap-2">
              <div class="w-4 h-4 text-moss-600 mt-1 flex-shrink-0">
                <svg class="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <Fragment set:html={iconMap['chevron']} />
                </svg>
              </div>
              <span class="text-charcoal-700">{activity}</span>
            </li>
          ))}
        </ul>
      </div>

      <!-- Winter Activities -->
      <div class="bg-sand-100 border-2 border-sand-300 rounded-xl p-8">
        <h3 class="text-2xl font-semibold text-wood-900 mb-4 flex items-center gap-3">
          <svg class="w-8 h-8 text-wood-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <Fragment set:html={iconMap['snowflake']} />
          </svg>
          Zimní aktivity
        </h3>
        <ul class="space-y-3">
          {aboutData.location.activities.winter.map((activity) => (
            <li class="flex items-start gap-2">
              <div class="w-4 h-4 text-wood-600 mt-1 flex-shrink-0">
                <svg class="w-full h-full" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <Fragment set:html={iconMap['chevron']} />
                </svg>
              </div>
              <span class="text-charcoal-700">{activity}</span>
            </li>
          ))}
        </ul>
      </div>
    </div>

    <!-- Directions -->
    <div class="mt-12 max-w-3xl mx-auto bg-sand-100 border-2 border-sand-300 rounded-xl p-6 text-center">
      <div class="flex items-center justify-center gap-2 mb-2">
        <svg class="w-5 h-5 text-moss-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <Fragment set:html={iconMap['map-pin']} />
        </svg>
        <p class="text-charcoal-700">
          <strong>Adresa:</strong> {siteData.location.address}, {siteData.location.region}
        </p>
      </div>
      <p class="text-sm text-charcoal-600 mt-2">
        GPS: {siteData.location.gps.lat}, {siteData.location.gps.lng}
      </p>
    </div>
  </div>
</section>
